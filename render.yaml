services:
  # ====================================
  # BACKEND: Flask API
  # ====================================
  - type: web
    name: flask-api
    runtime: docker
    dockerfilePath: ./api/Dockerfile
    dockerContext: ./api
    envVars:
      - key: FLASK_ENV
        value: production
      - key: DEBUG
        value: false
      - key: DATABASE_URL
        sync: false
    healthCheckPath: /api/health
    plan: free

---

  # ====================================
  # FRONTEND: Nginx
  # ====================================
  - type: web
    name: nginx-frontend
    runtime: docker
    dockerfilePath: ./nginx/Dockerfile.prod
    dockerContext: ./nginx
    envVars:
      # CORREGIDO: SOLO host:puerto (sin http://)
      - key: BACKEND_URL
        value: flask-api.onrender.internal:5000 
    plan: free

---

# ====================================
# BASE DE DATOS
# ====================================
databases:
  - name: mi-app-db
    databaseName: prod_db
    plan: free